<!DOCTYPE html>
<html>

<head>
    <title>Decryptinator</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
Uma notificação chega ao teu comunicador. Pelo toque sabes que é importante, é a comandante da estação.</p>

Reparas que o resto da tua equipa deve ter recebido a mesma notificação, estavam todos com um olhar misto de surpresa e preocupação... 
Todos sabiam que aquela notificação era um assunto sério e altamente sigiloso.</p>

Discretamente, cada um dos elementos saiu do lounge da estação e dirigiram-se para a caserna, a vossa base.</p>

À vossa espera está Philippa Georgiou, a comandante da estação. Georgiou tem um porte altivo e com marcas de uma vida dura, ela está naquele posto por mérito próprio, porém o seu semblante está diferente, algo o preocupa.</p>

- Não foi de ânimo leve que ativei o o código negro, eu coloquei um agente infiltrado para investigar o desaparecimento de artefactos alienígenas, o problema é que desapareceu um artefacto que é capaz de destruir toda a estação e o agente foi morto. - Georgiou partilha uma imagem da cena do crime.</p>


    <script src="sjcl.js"></script>

    <a href="decryptinator.html">Decryptinator </a><a href="encryptinator.html">Encryptinator</a></p>
    <p>key: <input type="text" id="key" name="key" /></p>
    <!-- <p>encrypted: <textarea id="secret" name="secret"></textarea></p> -->
    <button class="button" onclick=decryptinate()>Decryptinate</button>
    <p id="dec_msg">+PzJBrm5LbqwmdEkr94oZA==mPWHPsk6ppI=TNcnlPdsYDzK8ggRByzinOdtNqvFH+xpV0t7RHXsYQwpFu06u30T2YzjVHrETEWD4lTYVxS5OBdNWpj8Elw+DCi1SN0eV3KfVnsUAyxA/BumtkJkUbfNQgzSgV/J3Vflz8cVHdMt9cAcemLNbGV4r35FE6hkg2KTbPiO6uw/Mj4F5kjUnURSwcKai+aWklKL7m9UeZ0W1NzMWaiH9ViYQI/upWVzV3W4UGc8qWd60hjUZFaXPVXd4C3uDRHPie/v2LHAFb1EJsJg8rt7KqfWgukjhlt/FrAbZ3ulCWUHpIrV28dcCZCBMhXh6ZPoDknykyH92rKioNPIdW1SCGRoO67t4A+O4KpiOkZ2knjNYuWGXTUeFpoziHbUsE5o35AxMJWY0nVeNIFtNHSRM4LwID7StHBnpS93xurqazMVeSi29Sgb0YbSXhQmwU4Uf6Ilt5KySHzjQ6X+IwLJCWIoePBcZiIKMnqR6CyM8t2g9+DEZbjc7utTk09QZu21ylAc279mS+64BgyXBcT254lbwN/px2HL0mDa7M/5uRqkfc1SeJQtpceKuGe1zWSHjbJAD+4pbOF83O3m3hwwYfJQ+9YVVV1kye3YmHCt6s8IofM2OjvaxY8BPXVOtVMRppsRVhjbBMFGLC2tqslkDs1RnzIOM1KlzjPQ7cW7hn0gPn266JCsLCYLkdQd2TjNbD+Bv3Ghwrnx5/Hw98WlbwPtcegCgUnaOm1nLX2uU9ZAswQCm6Y7VoNi5gp3Rya3ho0kKgbfHvAFGLKBUr3lHC4u0udUJAUe7g4NkRA8nX7OiqeHBV3xYhGlosvFjARbbrZ6WJI7fR+5q9/jymeHMmugBncNUKc6CGUz4Cpt654t7QFedRPlU/UEP7jrOR3UMkOY1CofNt+b2c8NgVvQFSqBM5So2f9TQewr4CEukYx8sf9jvaLNciFCs/Q8r+oG2knZTllAW+hau6gJoOScR7vvuws96LI1jUV/mGOz49YTh7/4CqXlDl/+Z6dUeBru/tZPs8utdZXSgjlMbCAlwsWp4hWFc58yX1XTEQJVrIZDRi7tu1Piyl3UzMT1OiQEfWytZJfslfiWw57Y1DMVUK0x4jv9aU4bv9Sud4N9zQnVTIP/b05wutOYtOXSxCOLEzO+qepdJ/kqTA4bpKaTO5BtqmlzKao3UATQpMOKe2fnN0piIEvo8XtHd6y06HgZbdvC9ni3vutzZjWxaznKpV0Ofi6BPQ2vB2LZW3znFnyFjAgtg/DgE0Gent4+krb7/KcexHiAjZXrOb4Iv6+CY0Pf10YQDxlDvO0RIMJ6YR0fCLV7liTkdzfvl2Cfh+Z4A/xJQQlDSMuRTRCVmR9j7GzCMOKrtEq+HBHgkcByr4Jp8C07zRhN/iW4gZDf21a6uz5NCbuBO48Oj8PakkxOfz9fiGyI8EdSGrDY1HemUYcpHfNshAgzMAsCGvQ+86MkoAkbSm/I0xbwfvSlZvtVDeADV0soVleXjUem97DtNXr/jpnjI1sTKHr7uZgkoHBpTeIpPBn+DHqCy+mtluDpQF/27gkO0t2h4ril5QtIznN4lBeKkWhPWYq6L9AYBDhY7Z53pdSCkpfBRXU+IZw+F/yUA/Xhe0uJQyZyLn0b6Xyuxhr1hQ==</p>

    <script>
        function decryptinate() {
            var key = document.getElementById('key').value.toLowerCase().replace(/\s*$/, "");
            var iv = document.getElementById('dec_msg').value.substr(0, 24);
            var salt = document.getElementById('dec_msg').value.substr(24, 12);
            var ct = document.getElementById('dec_msg').value.substr(36, document.getElementById('dec_msg').value.length);
            var encrypted = '{ "iv":"' + iv + '","v":1,"iter":10000,"ks":128,"ts":64,"mode":"ccm","adata":"","cipher":"aes","salt":"' + salt + '","ct": "' + ct + '"}'
            document.getElementById('dec_msg').innerHTML = sjcl.decrypt(key, encrypted);
        }
    </script>

</body>

</html>

